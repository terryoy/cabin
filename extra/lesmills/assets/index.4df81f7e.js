import{o as i,c as u,a as r,t as p,F as m,r as C,p as T,b as A,d as g,e as V,f,g as k,h,w as R,i as $,j as B,k as E,l as L,u as I,m as F,n as S,q as H,s as O,v as w,x as j,y as G,z as q,A as U,B as z,C as Q}from"./vendor.da55cf35.js";const W=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function l(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(a){if(a.ep)return;a.ep=!0;const t=l(a);fetch(a.href,t)}};W();var y=(e,o)=>{const l=e.__vccOpts||e;for(const[s,a]of o)l[s]=a;return l};const J=e=>(T("data-v-53339dda"),e=e(),A(),e),X={class:"album-release"},Y=J(()=>r("thead",null,[r("tr",null,[r("th",null,"Track"),r("th",null,"Song"),r("th",null,"Artists")])],-1)),Z=["track"],ee=g(),se=g(),te={props:{release:{title:String}},setup(e){return(o,l)=>(i(),u("section",X,[r("h3",null,p(e.release.title),1),r("table",null,[Y,r("tbody",null,[(i(!0),u(m,null,C(e.release.tracks,s=>(i(),u("tr",{track:s},[r("td",null,p(s.trackNo),1),ee,r("td",null,p(s.song),1),se,r("td",null,p(s.singer),1)],8,Z))),256))])])]))}};var ae=y(te,[["__scopeId","data-v-53339dda"]]);const x=(e,...o)=>{const l=location.origin+location.pathname+e;return console.debug("request api:",l),V.get(l).then(s=>(console.log(s),s.data)).catch(s=>{console.error(s)})};const oe={components:{Release:ae},props:{src:String},data(){return{albums:[]}},mounted(){x(this.src).then(e=>this.albums=e.reverse())}},le=e=>(T("data-v-d939aaac"),e=e(),A(),e),ne=le(()=>r("h1",{id:"page-title"},"Les Mills - Body Combat - All Albums",-1)),re={class:"album-container"};function ce(e,o,l,s,a,t){const c=f("Release");return i(),u(m,null,[ne,r("div",re,[(i(!0),u(m,null,C(a.albums,n=>(i(),k(c,{release:n},null,8,["release"]))),256))])],64)}var ie=y(oe,[["render",ce],["__scopeId","data-v-d939aaac"]]);const ue={id:"app"},de={id:"nav"},_e=g("Home"),pe=g(" | "),he=g("LM Classes"),me={setup(e){const o=window.location.hash;return console.log("current path:",o),(l,s)=>{const a=f("router-link"),t=f("router-view");return i(),u("div",ue,[r("div",de,[h(a,{to:{name:"Home"}},{default:R(()=>[_e]),_:1}),pe,h(a,{to:{name:"LM Classes"}},{default:R(()=>[he]),_:1})]),h(t)])}}},fe={setup(e){return(o,l)=>(i(),k(ie,{src:"/data/bc_list.json"}))}},ge=Symbol("Global Data Store"),D=Symbol("Global Data Store Update"),K=Symbol("Global Data Store Get"),Ce=e=>e;var ye={props:["defaultStore"],setup(e){const o=$(e.defaultStore||{}),l=B(E(o)),s=(t,c,n=Ce)=>x(c).then(d=>(o[t]=n(d),console.debug(`state[${t}] fetchData:`,o[t]),o[t])),a=t=>l[t];L(ge,l),L(D,s),L(K,a)},render(){return this.$slots.default()}};const v={path:"/data/class.json",key:"LMClass"},ve={key:"LMReleaseData"},N={key:"LMAllTracks"},Re={[v.key]:[],[ve.key]:{},[N.key]:[]};const $e=e=>(T("data-v-e580032a"),e=e(),A(),e),be={class:"lm-album-release"},Le={class:"lm-release-title"},Ie=$e(()=>r("thead",null,[r("tr",null,[r("th",null,"Track No."),r("th",null,"Song"),r("th",null,"Artists"),r("th",null,"Duration"),r("th",null,"Exercise")])],-1)),Se=["track"],Te={props:["release"],setup(e){const l=e.release,s=t=>t.replaceAll(/[\(\'\)\â€™]/ig," "),a=async function(){console.log("copy release tracks:",l.tracks);const t=l.tracks.map(c=>`${s(c.ARTIST)} \u300A${s(c.TRACK)}\u300B`).join(`
`);await F(t),window.alert("Release tracks copied!")};return(t,c)=>(i(),u("section",be,[r("h3",Le,[g(p(I(l).title)+" ",1),r("button",{onClick:a},"Copy Tracks")]),r("table",null,[Ie,r("tbody",null,[(i(!0),u(m,null,C(I(l).tracks,n=>(i(),u("tr",{track:n},[r("td",null,p(n.TRACK_ID),1),r("td",null,p(n.TRACK),1),r("td",null,p(n.ARTIST),1),r("td",null,p(n.DURATION),1),r("td",null,p(n.TRACKNAME),1)],8,Se))),256))])])]))}};var Ae=y(Te,[["__scopeId","data-v-e580032a"]]);const De=(e,o,l=!1)=>{let s=0;for(;s<e.length&&s<o.length;s++)if(e[s]!==o[s])return s;return s},Me=e=>{const o=[];let l=null,s=0,a=null,t=null;const c=(n,d="",_=[])=>({title:n,prefix:d,tracks:_});return e.forEach(n=>{if(console.log("track:",n.TRACK_ID),!l)console.log("is first track",n.TRACK_ID),l=n,s=0;else{const d=De(l.TRACK_ID,n.TRACK_ID);if(s==0){console.log("check prefix length:",d,l.TRACK_ID.substring(0,d));const _=Number.isInteger(+l.TRACK_ID[d]),b=d+1===n.TRACK_ID.length;s=d-2,_&&(console.log("isLastCharNumber",b),s=d-1),a=l.TRACK_ID.substring(0,s),console.log("prefix match:",a,s),t=c(a,a,[l,n]),o.push(t)}else a!==n.TRACK_ID.substring(0,s)?(console.log("found next release:",n.TRACK_ID),l=n,s=0,t=null):(console.log("push track:",n.TRACK_ID,"prefixLength:",d),t.tracks.push(n))}}),console.log("all releases:",o),o},ke={class:"lm-release-list"},we={props:["lmclass"],setup(e){const o=e,l=S(D),s=$({lmclass:o.lmclass,releases:[]}),a=async t=>{const c=await l(N.key,t.all_tracks,Me);s.releases=c,console.log("allTracksResult",c)};return H(()=>o.lmclass,async()=>{await a(o.lmclass)}),O(async()=>{console.log("mounted:",o.lmclass),o.lmclass&&await a(o.lmclass)}),(t,c)=>(i(!0),u(m,null,C(I(s).releases,n=>(i(),u("div",ke,[h(Ae,{release:n},null,8,["release"])]))),256))}};const xe=w({props:["classId"],setup(e){const o=S(D),s=S(K)(v.key)||[],a=j();let t=null;s.length>0&&route.params&&(t=s.find(_=>_.id==classId));const c=$({loading:!0,currentClass:t});function n(_){if(_.length>0&&!t)return t=_[0],a.push({name:"LM Class Releases",params:{classId:t.id}}),null}async function d(_){this.state.loading=!0;const b=await o(v.key,v.path);this.state.currentClass=b.find(P=>P.id==_),G(()=>{this.state.loading=!1})}return n(s),{lmclasses:s,state:c,updateStore:o,fetchClasses:d,checkClassRoute:n}},watch:{classId:function(e){e&&this.fetchClasses(e)}},async mounted(){console.log("LMClassView mounted",this.classId),this.fetchClasses(this.classId)},async updated(){console.log("LMClassView updated",this.classId),this.checkClassRoute(this.lmclasses)},components:{LMClassReleaseList:we}}),Ke={class:"main-view"},Ne={class:"lm-class-navigation"},Pe={key:0,class:"album-container album-container-loading"},Ve={key:1,class:"album-container"};function Be(e,o,l,s,a,t){var d;const c=f("router-link"),n=f("LMClassReleaseList");return i(),u(m,null,[r("h1",null,p(((d=e.state.currentClass)==null?void 0:d.name)||"Les Mills"),1),r("div",Ke,[r("ul",Ne,[(i(!0),u(m,null,C(e.lmclasses,_=>(i(),u("li",null,[h(c,{to:{name:"LM Class Releases",params:{classId:_.id}}},{default:R(()=>[g(p(_.name),1)]),_:2},1032,["to"])]))),256))]),e.state.loading?(i(),u("div",Pe,"Loading...")):(i(),u("div",Ve,[h(n,{lmclass:e.state.currentClass},null,8,["lmclass"])]))])],64)}var Ee=y(xe,[["render",Be],["__scopeId","data-v-55dfe54d"]]);const Fe=w({setup(e){const o=q(),l=$(o.params);return{LMClassStore:Re,params:l}},watch:{$route:function(e){console.log("route changed!",e.params),this.params.classId=e.params.classId}},components:{DataProvider:ye,LMClassView:Ee}}),He={class:"lesmills-home"};function Oe(e,o,l,s,a,t){const c=f("LMClassView"),n=f("DataProvider");return i(),u("div",He,[h(n,{defaultStore:e.LMClassStore},{default:R(()=>[h(c,{classId:e.params.classId},null,8,["classId"])]),_:1},8,["defaultStore"])])}var M=y(Fe,[["render",Oe]]);const je=[{path:"/",name:"Home",component:fe},{path:"/class",name:"LM Classes",component:M},{path:"/class/:classId/releases/",name:"LM Class Releases",component:M}],Ge=U({history:z(),routes:je}),qe=Q(me);qe.use(Ge).mount("#app");
