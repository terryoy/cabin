import{o as i,c as d,a as n,t as p,F as m,r as C,p as T,b as D,d as g,e as f,f as k,g as h,w as R,h as b,i as V,j,k as L,u as I,l as B,m as S,n as F,q as H,s as w,v as O,x as E,y as G,z as q,A as U,B as z}from"./vendor.0c6b4862.js";const Q=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function l(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(a){if(a.ep)return;a.ep=!0;const t=l(a);fetch(a.href,t)}};Q();var y=(e,o)=>{const l=e.__vccOpts||e;for(const[s,a]of o)l[s]=a;return l};const W=e=>(T("data-v-53339dda"),e=e(),D(),e),J={class:"album-release"},X=W(()=>n("thead",null,[n("tr",null,[n("th",null,"Track"),n("th",null,"Song"),n("th",null,"Artists")])],-1)),Y=["track"],Z=g(),ee=g(),se={props:{release:{title:String}},setup(e){return(o,l)=>(i(),d("section",J,[n("h3",null,p(e.release.title),1),n("table",null,[X,n("tbody",null,[(i(!0),d(m,null,C(e.release.tracks,s=>(i(),d("tr",{track:s},[n("td",null,p(s.trackNo),1),Z,n("td",null,p(s.song),1),ee,n("td",null,p(s.singer),1)],8,Y))),256))])])]))}};var te=y(se,[["__scopeId","data-v-53339dda"]]);const x=(e,...o)=>{const l=location.pathname;return fetch(l+e)};const ae={components:{Release:te},props:{src:String},data(){return{albums:[]}},mounted(){x(this.src).then(e=>e.json()).then(e=>this.albums=e.reverse())}},oe=e=>(T("data-v-581cb2d7"),e=e(),D(),e),le=oe(()=>n("h1",{id:"page-title"},"Les Mills - Body Combat - All Albums",-1)),ne={class:"album-container"};function re(e,o,l,s,a,t){const r=f("Release");return i(),d(m,null,[le,n("div",ne,[(i(!0),d(m,null,C(a.albums,c=>(i(),k(r,{release:c},null,8,["release"]))),256))])],64)}var ce=y(ae,[["render",re],["__scopeId","data-v-581cb2d7"]]);const ie={id:"app"},ue={id:"nav"},de=g("Home"),_e=g(" | "),pe=g("LM Classes"),he={setup(e){const o=window.location.hash;return console.log("current path:",o),(l,s)=>{const a=f("router-link"),t=f("router-view");return i(),d("div",ie,[n("div",ue,[h(a,{to:{name:"Home"}},{default:R(()=>[de]),_:1}),_e,h(a,{to:{name:"LM Classes"}},{default:R(()=>[pe]),_:1})]),h(t)])}}},me={setup(e){return(o,l)=>(i(),k(ce,{src:"/data/bc_list.json"}))}},fe=Symbol("Global Data Store"),M=Symbol("Global Data Store Update"),K=Symbol("Global Data Store Get"),ge=e=>e;var Ce={props:["defaultStore"],setup(e){const o=b(e.defaultStore||{}),l=V(j(o)),s=(t,r,c=ge)=>x(r).then(u=>u.json()).then(u=>(o[t]=c(u),console.debug(`state[${t}] fetchData:`,o[t]),o[t])),a=t=>l[t];L(fe,l),L(M,s),L(K,a)},render(){return this.$slots.default()}};const v={path:"/data/class.json",key:"LMClass"},ye={key:"LMReleaseData"},N={key:"LMAllTracks"},ve={[v.key]:[],[ye.key]:{},[N.key]:[]};const Re=e=>(T("data-v-6fa85817"),e=e(),D(),e),be={class:"lm-album-release"},$e={class:"lm-release-title"},Le=Re(()=>n("thead",null,[n("tr",null,[n("th",null,"Track No."),n("th",null,"Song"),n("th",null,"Artists"),n("th",null,"Duration"),n("th",null,"Exercise")])],-1)),Ie=["track"],Se={props:["release"],setup(e){const l=e.release,s=async function(){console.log("copy release tracks:",l.tracks);const a=l.tracks.map(t=>`${t.TRACK} \u300A${t.ARTIST}\u300B`).join(`
`);await B(a),window.alert("Release tracks copied!")};return(a,t)=>(i(),d("section",be,[n("h3",$e,[g(p(I(l).title)+" ",1),n("button",{onClick:s},"Copy Tracks")]),n("table",null,[Le,n("tbody",null,[(i(!0),d(m,null,C(I(l).tracks,r=>(i(),d("tr",{track:r},[n("td",null,p(r.TRACK_ID),1),n("td",null,p(r.TRACK),1),n("td",null,p(r.ARTIST),1),n("td",null,p(r.DURATION),1),n("td",null,p(r.TRACKNAME),1)],8,Ie))),256))])])]))}};var Te=y(Se,[["__scopeId","data-v-6fa85817"]]);const De=(e,o,l=!1)=>{let s=0;for(;s<e.length&&s<o.length;s++)if(e[s]!==o[s])return s;return s},Me=e=>{const o=[];let l=null,s=0,a=null,t=null;const r=(c,u="",_=[])=>({title:c,prefix:u,tracks:_});return e.forEach(c=>{if(console.log("track:",c.TRACK_ID),!l)console.log("is first track",c.TRACK_ID),l=c,s=0;else{const u=De(l.TRACK_ID,c.TRACK_ID);if(s==0){console.log("check prefix length:",u,l.TRACK_ID.substring(0,u));const _=Number.isInteger(+l.TRACK_ID[u]),$=u+1===c.TRACK_ID.length;s=u-2,_&&(console.log("isLastCharNumber",$),s=u-1),a=l.TRACK_ID.substring(0,s),console.log("prefix match:",a,s),t=r(a,a,[l,c]),o.push(t)}else a!==c.TRACK_ID.substring(0,s)?(console.log("found next release:",c.TRACK_ID),l=c,s=0,t=null):(console.log("push track:",c.TRACK_ID,"prefixLength:",u),t.tracks.push(c))}}),console.log("all releases:",o),o},Ae={class:"lm-release-list"},ke={props:["lmclass"],setup(e){const o=e,l=S(M),s=b({lmclass:o.lmclass,releases:[]}),a=async t=>{const r=await l(N.key,t.all_tracks,Me);s.releases=r,console.log("allTracksResult",r)};return F(()=>o.lmclass,async()=>{await a(o.lmclass)}),H(async()=>{console.log("mounted:",o.lmclass),o.lmclass&&await a(o.lmclass)}),(t,r)=>(i(!0),d(m,null,C(I(s).releases,c=>(i(),d("div",Ae,[h(Te,{release:c},null,8,["release"])]))),256))}};const we=w({props:["classId"],setup(e){const o=S(M),s=S(K)(v.key)||[],a=O();let t=null;s.length>0&&route.params&&(t=s.find(_=>_.id==classId));const r=b({loading:!0,currentClass:t});function c(_){if(_.length>0&&!t)return t=_[0],a.push({name:"LM Class Releases",params:{classId:t.id}}),null}async function u(_){this.state.loading=!0;const $=await o(v.key,v.path);this.state.currentClass=$.find(P=>P.id==_),E(()=>{this.state.loading=!1})}return c(s),{lmclasses:s,state:r,updateStore:o,fetchClasses:u,checkClassRoute:c}},watch:{classId:function(e){e&&this.fetchClasses(e)}},async mounted(){console.log("LMClassView mounted",this.classId),this.fetchClasses(this.classId)},async updated(){console.log("LMClassView updated",this.classId),this.checkClassRoute(this.lmclasses)},components:{LMClassReleaseList:ke}}),xe={class:"main-view"},Ke={class:"lm-class-navigation"},Ne={key:0,class:"album-container album-container-loading"},Pe={key:1,class:"album-container"};function Ve(e,o,l,s,a,t){var u;const r=f("router-link"),c=f("LMClassReleaseList");return i(),d(m,null,[n("h1",null,p(((u=e.state.currentClass)==null?void 0:u.name)||"Les Mills"),1),n("div",xe,[n("ul",Ke,[(i(!0),d(m,null,C(e.lmclasses,_=>(i(),d("li",null,[h(r,{to:{name:"LM Class Releases",params:{classId:_.id}}},{default:R(()=>[g(p(_.name),1)]),_:2},1032,["to"])]))),256))]),e.state.loading?(i(),d("div",Ne,"Loading...")):(i(),d("div",Pe,[h(c,{lmclass:e.state.currentClass},null,8,["lmclass"])]))])],64)}var je=y(we,[["render",Ve],["__scopeId","data-v-55dfe54d"]]);const Be=w({setup(e){const o=G(),l=b(o.params);return{LMClassStore:ve,params:l}},watch:{$route:function(e){console.log("route changed!",e.params),this.params.classId=e.params.classId}},components:{DataProvider:Ce,LMClassView:je}}),Fe={class:"lesmills-home"};function He(e,o,l,s,a,t){const r=f("LMClassView"),c=f("DataProvider");return i(),d("div",Fe,[h(c,{defaultStore:e.LMClassStore},{default:R(()=>[h(r,{classId:e.params.classId},null,8,["classId"])]),_:1},8,["defaultStore"])])}var A=y(Be,[["render",He]]);const Oe=[{path:"/",name:"Home",component:me},{path:"/class",name:"LM Classes",component:A},{path:"/class/:classId/releases/",name:"LM Class Releases",component:A}],Ee=q({history:U(),routes:Oe}),Ge=z(he);Ge.use(Ee).mount("#app");
