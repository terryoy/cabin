import{o as d,c as _,a as n,t as p,F as m,r as y,p as k,b as M,d as g,e as V,f,g as T,h,w as L,i as b,j as O,k as B,l as I,u as $,m as E,n as S,q as F,s as H,v as w,x as j,y as G,z as q,A as U,B as z,C as Q}from"./vendor.da55cf35.js";const W=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(o){if(o.ep)return;o.ep=!0;const t=r(o);fetch(o.href,t)}};W();var v=(s,l)=>{const r=s.__vccOpts||s;for(const[e,o]of l)r[e]=o;return r};const J=s=>(k("data-v-53339dda"),s=s(),M(),s),X={class:"album-release"},Y=J(()=>n("thead",null,[n("tr",null,[n("th",null,"Track"),n("th",null,"Song"),n("th",null,"Artists")])],-1)),Z=["track"],ee=g(),se=g(),te={props:{release:{title:String}},setup(s){return(l,r)=>(d(),_("section",X,[n("h3",null,p(s.release.title),1),n("table",null,[Y,n("tbody",null,[(d(!0),_(m,null,y(s.release.tracks,e=>(d(),_("tr",{track:e},[n("td",null,p(e.trackNo),1),ee,n("td",null,p(e.song),1),se,n("td",null,p(e.singer),1)],8,Z))),256))])])]))}};var ae=v(te,[["__scopeId","data-v-53339dda"]]);const x=(s,...l)=>{const r=location.origin+location.pathname+s;return console.debug("request api:",r),V.get(r).then(e=>(console.log(e),e.data)).catch(e=>{console.error(e)})};const oe={components:{Release:ae},props:{src:String},data(){return{albums:[]}},mounted(){x(this.src).then(s=>this.albums=s.reverse())}},le=s=>(k("data-v-d939aaac"),s=s(),M(),s),ne=le(()=>n("h1",{id:"page-title"},"Les Mills - Body Combat - All Albums",-1)),re={class:"album-container"};function ce(s,l,r,e,o,t){const i=f("Release");return d(),_(m,null,[ne,n("div",re,[(d(!0),_(m,null,y(o.albums,a=>(d(),T(i,{release:a},null,8,["release"]))),256))])],64)}var ie=v(oe,[["render",ce],["__scopeId","data-v-d939aaac"]]);const ue={id:"app"},de={id:"nav"},_e=g("Home"),pe=g(" | "),he=g("LM Classes"),me={setup(s){const l=window.location.hash;return console.log("current path:",l),(r,e)=>{const o=f("router-link"),t=f("router-view");return d(),_("div",ue,[n("div",de,[h(o,{to:{name:"Home"}},{default:L(()=>[_e]),_:1}),pe,h(o,{to:{name:"LM Classes"}},{default:L(()=>[he]),_:1})]),h(t)])}}},fe={setup(s){return(l,r)=>(d(),T(ie,{src:"/data/bc_list.json"}))}},ge=Symbol("Global Data Store"),A=Symbol("Global Data Store Update"),K=Symbol("Global Data Store Get"),Ce=s=>s;var ye={props:["defaultStore"],setup(s){const l=b(s.defaultStore||{}),r=O(B(l)),e=(t,i,a=Ce)=>x(i).then(c=>(l[t]=a(c),console.debug(`state[${t}] fetchData:`,l[t]),l[t])),o=t=>r[t];I(ge,r),I(A,e),I(K,o)},render(){return this.$slots.default()}};const R={path:"/data/class.json",key:"LMClass"},ve={key:"LMReleaseData"},N={key:"LMAllTracks"},Re={[R.key]:[],[ve.key]:{},[N.key]:[]};const Le=s=>(k("data-v-e580032a"),s=s(),M(),s),$e={class:"lm-album-release"},be={class:"lm-release-title"},Ie=Le(()=>n("thead",null,[n("tr",null,[n("th",null,"Track No."),n("th",null,"Song"),n("th",null,"Artists"),n("th",null,"Duration"),n("th",null,"Exercise")])],-1)),Se=["track"],ke={props:["release"],setup(s){const r=s.release,e=t=>t.replaceAll(/[\(\'\)\â€™]/ig," "),o=async function(){console.log("copy release tracks:",r.tracks);const t=r.tracks.map(i=>`${e(i.ARTIST)} \u300A${e(i.TRACK)}\u300B`).join(`
`);await E(t),window.alert("Release tracks copied!")};return(t,i)=>(d(),_("section",$e,[n("h3",be,[g(p($(r).title)+" ",1),n("button",{onClick:o},"Copy Tracks")]),n("table",null,[Ie,n("tbody",null,[(d(!0),_(m,null,y($(r).tracks,a=>(d(),_("tr",{track:a},[n("td",null,p(a.TRACK_ID),1),n("td",null,p(a.TRACK),1),n("td",null,p(a.ARTIST),1),n("td",null,p(a.DURATION),1),n("td",null,p(a.TRACKNAME),1)],8,Se))),256))])])]))}};var Me=v(ke,[["__scopeId","data-v-e580032a"]]);const Ae=(s,l,r=!1)=>{let e=0;for(;e<s.length&&e<l.length;e++)if(s[e]!==l[e])return e;return e},De=s=>{const l=[];let r=null,e=0,o=null,t=null;const i=(a,c="",u=[])=>({title:a,prefix:c,tracks:u});return s.forEach(a=>{if(console.log("track:",a.TRACK_ID),!r)console.log("is first track",a.TRACK_ID),r=a,e=0;else{const c=Ae(r.TRACK_ID,a.TRACK_ID);if(e==0){console.log("check prefix length:",c,r.TRACK_ID.substring(0,c));const u=Number.isInteger(+r.TRACK_ID[c]),C=c+1===a.TRACK_ID.length;e=c-2,u&&(console.log("isLastCharNumber",C),e=c-1),o=r.TRACK_ID.substring(0,e),console.log("prefix match:",o,e),t=i(o,o,[r,a]),l.push(t)}else o!==a.TRACK_ID.substring(0,e)?(console.log("found next release:",a.TRACK_ID),r=a,e=0,t=null):(console.log("push track:",a.TRACK_ID,"prefixLength:",c),t.tracks.push(a))}}),console.log("all releases:",l),l};const Te={class:"lm-release-search"},we=n("label",null,"Search:",-1),xe=["value"],Ke={props:["lmclass"],setup(s){const l=s,r=S(A),e=b({lmclass:l.lmclass,keyword:"",releases:[],filterReleases:[]}),o=(a,c)=>{const u=(c||"").trim().toLowerCase();return u?a.filter(C=>(C.title||"").toLowerCase().indexOf(u)>-1):a},t=async a=>{const c=await r(N.key,a.all_tracks,De);e.releases=c,e.filterReleases=o(c,e.keyword)};F(()=>l.lmclass,async()=>{await t(l.lmclass)}),H(async()=>{l.lmclass&&await t(l.lmclass)});const i=a=>{e.keyword=a,e.filterReleases=o(e.releases,a),console.log("search:",a,e.filterReleases)};return(a,c)=>(d(),_(m,null,[n("div",Te,[we,n("input",{value:$(e).keyword,onInput:c[0]||(c[0]=u=>i(u.target.value))},null,40,xe),n("button",{onClick:c[1]||(c[1]=()=>i(""))},"Clear")]),(d(!0),_(m,null,y($(e).filterReleases,u=>(d(),_("div",{class:"lm-release-list",key:u.title},[h(Me,{release:u},null,8,["release"])]))),128))],64))}};const Ne=w({props:["classId"],setup(s){const l=S(A),e=S(K)(R.key)||[],o=j();let t=null;e.length>0&&route.params&&(t=e.find(u=>u.id==classId));const i=b({loading:!0,currentClass:t});function a(u){if(u.length>0&&!t)return t=u[0],o.push({name:"LM Class Releases",params:{classId:t.id}}),null}async function c(u){this.state.loading=!0;const C=await l(R.key,R.path);this.state.currentClass=C.find(P=>P.id==u),G(()=>{this.state.loading=!1})}return a(e),{lmclasses:e,state:i,updateStore:l,fetchClasses:c,checkClassRoute:a}},watch:{classId:function(s){s&&this.fetchClasses(s)}},async mounted(){console.log("LMClassView mounted",this.classId),this.fetchClasses(this.classId)},async updated(){console.log("LMClassView updated",this.classId),this.checkClassRoute(this.lmclasses)},components:{LMClassReleaseList:Ke}}),Pe={class:"main-view"},Ve={class:"lm-class-navigation"},Oe={key:0,class:"album-container album-container-loading"},Be={key:1,class:"album-container"};function Ee(s,l,r,e,o,t){var c;const i=f("router-link"),a=f("LMClassReleaseList");return d(),_(m,null,[n("h1",null,p(((c=s.state.currentClass)==null?void 0:c.name)||"Les Mills"),1),n("div",Pe,[n("ul",Ve,[(d(!0),_(m,null,y(s.lmclasses,u=>(d(),_("li",null,[h(i,{to:{name:"LM Class Releases",params:{classId:u.id}}},{default:L(()=>[g(p(u.name),1)]),_:2},1032,["to"])]))),256))]),s.state.loading?(d(),_("div",Oe,"Loading...")):(d(),_("div",Be,[h(a,{lmclass:s.state.currentClass},null,8,["lmclass"])]))])],64)}var Fe=v(Ne,[["render",Ee],["__scopeId","data-v-55dfe54d"]]);const He=w({setup(s){const l=q(),r=b(l.params);return{LMClassStore:Re,params:r}},watch:{$route:function(s){console.log("route changed!",s.params),this.params.classId=s.params.classId}},components:{DataProvider:ye,LMClassView:Fe}}),je={class:"lesmills-home"};function Ge(s,l,r,e,o,t){const i=f("LMClassView"),a=f("DataProvider");return d(),_("div",je,[h(a,{defaultStore:s.LMClassStore},{default:L(()=>[h(i,{classId:s.params.classId},null,8,["classId"])]),_:1},8,["defaultStore"])])}var D=v(He,[["render",Ge]]);const qe=[{path:"/",name:"Home",component:fe},{path:"/class",name:"LM Classes",component:D},{path:"/class/:classId/releases/",name:"LM Class Releases",component:D}],Ue=U({history:z(),routes:qe}),ze=Q(me);ze.use(Ue).mount("#app");
