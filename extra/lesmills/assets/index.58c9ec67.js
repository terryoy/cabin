import{o as i,c as u,a as n,t as p,F as m,r as C,p as T,b as D,d as g,e as V,f,g as k,h,w as R,i as $,j as B,k as F,l as L,u as I,m as H,n as S,q as O,s as j,v as w,x as E,y as G,z as q,A as U,B as z,C as Q}from"./vendor.da55cf35.js";const W=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function l(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(a){if(a.ep)return;a.ep=!0;const t=l(a);fetch(a.href,t)}};W();var y=(e,o)=>{const l=e.__vccOpts||e;for(const[s,a]of o)l[s]=a;return l};const J=e=>(T("data-v-53339dda"),e=e(),D(),e),X={class:"album-release"},Y=J(()=>n("thead",null,[n("tr",null,[n("th",null,"Track"),n("th",null,"Song"),n("th",null,"Artists")])],-1)),Z=["track"],ee=g(),se=g(),te={props:{release:{title:String}},setup(e){return(o,l)=>(i(),u("section",X,[n("h3",null,p(e.release.title),1),n("table",null,[Y,n("tbody",null,[(i(!0),u(m,null,C(e.release.tracks,s=>(i(),u("tr",{track:s},[n("td",null,p(s.trackNo),1),ee,n("td",null,p(s.song),1),se,n("td",null,p(s.singer),1)],8,Z))),256))])])]))}};var ae=y(te,[["__scopeId","data-v-53339dda"]]);const x=(e,...o)=>{const l=location.origin+location.pathname+e;return console.debug("request api:",l),V.get(l).then(s=>(console.log(s),s.data)).catch(s=>{console.error(s)})};const oe={components:{Release:ae},props:{src:String},data(){return{albums:[]}},mounted(){x(this.src).then(e=>this.albums=e.reverse())}},le=e=>(T("data-v-d939aaac"),e=e(),D(),e),ne=le(()=>n("h1",{id:"page-title"},"Les Mills - Body Combat - All Albums",-1)),re={class:"album-container"};function ce(e,o,l,s,a,t){const r=f("Release");return i(),u(m,null,[ne,n("div",re,[(i(!0),u(m,null,C(a.albums,c=>(i(),k(r,{release:c},null,8,["release"]))),256))])],64)}var ie=y(oe,[["render",ce],["__scopeId","data-v-d939aaac"]]);const ue={id:"app"},de={id:"nav"},_e=g("Home"),pe=g(" | "),he=g("LM Classes"),me={setup(e){const o=window.location.hash;return console.log("current path:",o),(l,s)=>{const a=f("router-link"),t=f("router-view");return i(),u("div",ue,[n("div",de,[h(a,{to:{name:"Home"}},{default:R(()=>[_e]),_:1}),pe,h(a,{to:{name:"LM Classes"}},{default:R(()=>[he]),_:1})]),h(t)])}}},fe={setup(e){return(o,l)=>(i(),k(ie,{src:"/data/bc_list.json"}))}},ge=Symbol("Global Data Store"),M=Symbol("Global Data Store Update"),K=Symbol("Global Data Store Get"),Ce=e=>e;var ye={props:["defaultStore"],setup(e){const o=$(e.defaultStore||{}),l=B(F(o)),s=(t,r,c=Ce)=>x(r).then(d=>(o[t]=c(d),console.debug(`state[${t}] fetchData:`,o[t]),o[t])),a=t=>l[t];L(ge,l),L(M,s),L(K,a)},render(){return this.$slots.default()}};const v={path:"/data/class.json",key:"LMClass"},ve={key:"LMReleaseData"},N={key:"LMAllTracks"},Re={[v.key]:[],[ve.key]:{},[N.key]:[]};const $e=e=>(T("data-v-6fa85817"),e=e(),D(),e),be={class:"lm-album-release"},Le={class:"lm-release-title"},Ie=$e(()=>n("thead",null,[n("tr",null,[n("th",null,"Track No."),n("th",null,"Song"),n("th",null,"Artists"),n("th",null,"Duration"),n("th",null,"Exercise")])],-1)),Se=["track"],Te={props:["release"],setup(e){const l=e.release,s=async function(){console.log("copy release tracks:",l.tracks);const a=l.tracks.map(t=>`${t.TRACK} \u300A${t.ARTIST}\u300B`).join(`
`);await H(a),window.alert("Release tracks copied!")};return(a,t)=>(i(),u("section",be,[n("h3",Le,[g(p(I(l).title)+" ",1),n("button",{onClick:s},"Copy Tracks")]),n("table",null,[Ie,n("tbody",null,[(i(!0),u(m,null,C(I(l).tracks,r=>(i(),u("tr",{track:r},[n("td",null,p(r.TRACK_ID),1),n("td",null,p(r.TRACK),1),n("td",null,p(r.ARTIST),1),n("td",null,p(r.DURATION),1),n("td",null,p(r.TRACKNAME),1)],8,Se))),256))])])]))}};var De=y(Te,[["__scopeId","data-v-6fa85817"]]);const Me=(e,o,l=!1)=>{let s=0;for(;s<e.length&&s<o.length;s++)if(e[s]!==o[s])return s;return s},Ae=e=>{const o=[];let l=null,s=0,a=null,t=null;const r=(c,d="",_=[])=>({title:c,prefix:d,tracks:_});return e.forEach(c=>{if(console.log("track:",c.TRACK_ID),!l)console.log("is first track",c.TRACK_ID),l=c,s=0;else{const d=Me(l.TRACK_ID,c.TRACK_ID);if(s==0){console.log("check prefix length:",d,l.TRACK_ID.substring(0,d));const _=Number.isInteger(+l.TRACK_ID[d]),b=d+1===c.TRACK_ID.length;s=d-2,_&&(console.log("isLastCharNumber",b),s=d-1),a=l.TRACK_ID.substring(0,s),console.log("prefix match:",a,s),t=r(a,a,[l,c]),o.push(t)}else a!==c.TRACK_ID.substring(0,s)?(console.log("found next release:",c.TRACK_ID),l=c,s=0,t=null):(console.log("push track:",c.TRACK_ID,"prefixLength:",d),t.tracks.push(c))}}),console.log("all releases:",o),o},ke={class:"lm-release-list"},we={props:["lmclass"],setup(e){const o=e,l=S(M),s=$({lmclass:o.lmclass,releases:[]}),a=async t=>{const r=await l(N.key,t.all_tracks,Ae);s.releases=r,console.log("allTracksResult",r)};return O(()=>o.lmclass,async()=>{await a(o.lmclass)}),j(async()=>{console.log("mounted:",o.lmclass),o.lmclass&&await a(o.lmclass)}),(t,r)=>(i(!0),u(m,null,C(I(s).releases,c=>(i(),u("div",ke,[h(De,{release:c},null,8,["release"])]))),256))}};const xe=w({props:["classId"],setup(e){const o=S(M),s=S(K)(v.key)||[],a=E();let t=null;s.length>0&&route.params&&(t=s.find(_=>_.id==classId));const r=$({loading:!0,currentClass:t});function c(_){if(_.length>0&&!t)return t=_[0],a.push({name:"LM Class Releases",params:{classId:t.id}}),null}async function d(_){this.state.loading=!0;const b=await o(v.key,v.path);this.state.currentClass=b.find(P=>P.id==_),G(()=>{this.state.loading=!1})}return c(s),{lmclasses:s,state:r,updateStore:o,fetchClasses:d,checkClassRoute:c}},watch:{classId:function(e){e&&this.fetchClasses(e)}},async mounted(){console.log("LMClassView mounted",this.classId),this.fetchClasses(this.classId)},async updated(){console.log("LMClassView updated",this.classId),this.checkClassRoute(this.lmclasses)},components:{LMClassReleaseList:we}}),Ke={class:"main-view"},Ne={class:"lm-class-navigation"},Pe={key:0,class:"album-container album-container-loading"},Ve={key:1,class:"album-container"};function Be(e,o,l,s,a,t){var d;const r=f("router-link"),c=f("LMClassReleaseList");return i(),u(m,null,[n("h1",null,p(((d=e.state.currentClass)==null?void 0:d.name)||"Les Mills"),1),n("div",Ke,[n("ul",Ne,[(i(!0),u(m,null,C(e.lmclasses,_=>(i(),u("li",null,[h(r,{to:{name:"LM Class Releases",params:{classId:_.id}}},{default:R(()=>[g(p(_.name),1)]),_:2},1032,["to"])]))),256))]),e.state.loading?(i(),u("div",Pe,"Loading...")):(i(),u("div",Ve,[h(c,{lmclass:e.state.currentClass},null,8,["lmclass"])]))])],64)}var Fe=y(xe,[["render",Be],["__scopeId","data-v-55dfe54d"]]);const He=w({setup(e){const o=q(),l=$(o.params);return{LMClassStore:Re,params:l}},watch:{$route:function(e){console.log("route changed!",e.params),this.params.classId=e.params.classId}},components:{DataProvider:ye,LMClassView:Fe}}),Oe={class:"lesmills-home"};function je(e,o,l,s,a,t){const r=f("LMClassView"),c=f("DataProvider");return i(),u("div",Oe,[h(c,{defaultStore:e.LMClassStore},{default:R(()=>[h(r,{classId:e.params.classId},null,8,["classId"])]),_:1},8,["defaultStore"])])}var A=y(He,[["render",je]]);const Ee=[{path:"/",name:"Home",component:fe},{path:"/class",name:"LM Classes",component:A},{path:"/class/:classId/releases/",name:"LM Class Releases",component:A}],Ge=U({history:z(),routes:Ee}),qe=Q(me);qe.use(Ge).mount("#app");
