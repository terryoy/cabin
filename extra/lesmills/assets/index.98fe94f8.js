import{o as i,c as d,a as n,t as p,F as m,r as C,p as T,b as D,d as g,e as f,f as k,g as h,w as R,h as b,i as P,j as V,k as L,u as I,l as j,m as S,n as B,q as F,s as w,v as H,x as O,y as E,z as G,A as q,B as U}from"./vendor.0c6b4862.js";const z=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function l(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(a){if(a.ep)return;a.ep=!0;const t=l(a);fetch(a.href,t)}};z();var y=(e,o)=>{const l=e.__vccOpts||e;for(const[s,a]of o)l[s]=a;return l};const Q=e=>(T("data-v-53339dda"),e=e(),D(),e),W={class:"album-release"},J=Q(()=>n("thead",null,[n("tr",null,[n("th",null,"Track"),n("th",null,"Song"),n("th",null,"Artists")])],-1)),X=["track"],Y=g(),Z=g(),ee={props:{release:{title:String}},setup(e){return(o,l)=>(i(),d("section",W,[n("h3",null,p(e.release.title),1),n("table",null,[J,n("tbody",null,[(i(!0),d(m,null,C(e.release.tracks,s=>(i(),d("tr",{track:s},[n("td",null,p(s.trackNo),1),Y,n("td",null,p(s.song),1),Z,n("td",null,p(s.singer),1)],8,X))),256))])])]))}};var se=y(ee,[["__scopeId","data-v-53339dda"]]);const te={components:{Release:se},props:{src:String},data(){return{albums:[]}},mounted(){fetch(this.src).then(e=>e.json()).then(e=>this.albums=e.reverse())}},ae=e=>(T("data-v-2aaf9404"),e=e(),D(),e),oe=ae(()=>n("h1",{id:"page-title"},"Les Mills - Body Combat - All Albums",-1)),le={class:"album-container"};function ne(e,o,l,s,a,t){const r=f("Release");return i(),d(m,null,[oe,n("div",le,[(i(!0),d(m,null,C(a.albums,c=>(i(),k(r,{release:c},null,8,["release"]))),256))])],64)}var re=y(te,[["render",ne],["__scopeId","data-v-2aaf9404"]]);const ce={id:"app"},ie={id:"nav"},ue=g("Home"),de=g(" | "),_e=g("LM Classes"),pe={setup(e){const o=window.location.hash;return console.log("current path:",o),(l,s)=>{const a=f("router-link"),t=f("router-view");return i(),d("div",ce,[n("div",ie,[h(a,{to:{name:"Home"}},{default:R(()=>[ue]),_:1}),de,h(a,{to:{name:"LM Classes"}},{default:R(()=>[_e]),_:1})]),h(t)])}}},he={setup(e){return(o,l)=>(i(),k(re,{src:"/data/bc_list.json"}))}},me=Symbol("Global Data Store"),M=Symbol("Global Data Store Update"),x=Symbol("Global Data Store Get"),fe=e=>e;var ge={props:["defaultStore"],setup(e){const o=b(e.defaultStore||{}),l=P(V(o)),s=(t,r,c=fe)=>fetch(r).then(u=>u.json()).then(u=>(o[t]=c(u),console.debug(`state[${t}] fetchData:`,o[t]),o[t])),a=t=>l[t];L(me,l),L(M,s),L(x,a)},render(){return this.$slots.default()}};const v={path:"/data/class.json",key:"LMClass"},Ce={key:"LMReleaseData"},K={key:"LMAllTracks"},ye={[v.key]:[],[Ce.key]:{},[K.key]:[]};const ve=e=>(T("data-v-2c59b5c7"),e=e(),D(),e),Re={class:"lm-album-release"},be={class:"lm-release-title"},$e=ve(()=>n("thead",null,[n("tr",null,[n("th",null,"Track No."),n("th",null,"Song"),n("th",null,"Artists"),n("th",null,"Duration"),n("th",null,"Exercise")])],-1)),Le=["track"],Ie={props:["release"],setup(e){const l=e.release,s=async function(){console.log("copy release tracks:",l.tracks);const a=l.tracks.map(t=>`${t.TRACK} \u300A${t.ARTIST}\u300B`).join(`
`);await j(a),window.alert("Release tracks copied!")};return(a,t)=>(i(),d("section",Re,[n("h3",be,[g(p(I(l).title)+" ",1),n("button",{onClick:s},"Copy Tracks")]),n("table",null,[$e,n("tbody",null,[(i(!0),d(m,null,C(I(l).tracks,r=>(i(),d("tr",{track:r},[n("td",null,p(r.TRACK_ID),1),n("td",null,p(r.TRACK),1),n("td",null,p(r.ARTIST),1),n("td",null,p(r.DURATION),1),n("td",null,p(r.TRACKNAME),1)],8,Le))),256))])])]))}};var Se=y(Ie,[["__scopeId","data-v-2c59b5c7"]]);const Te=(e,o,l=!1)=>{let s=0;for(;s<e.length&&s<o.length;s++)if(e[s]!==o[s])return s;return s},De=e=>{const o=[];let l=null,s=0,a=null,t=null;const r=(c,u="",_=[])=>({title:c,prefix:u,tracks:_});return e.forEach(c=>{if(console.log("track:",c.TRACK_ID),!l)console.log("is first track",c.TRACK_ID),l=c,s=0;else{const u=Te(l.TRACK_ID,c.TRACK_ID);if(s==0){console.log("check prefix length:",u,l.TRACK_ID.substring(0,u));const _=Number.isInteger(+l.TRACK_ID[u]),$=u+1===c.TRACK_ID.length;s=u-2,_&&(console.log("isLastCharNumber",$),s=u-1),a=l.TRACK_ID.substring(0,s),console.log("prefix match:",a,s),t=r(a,a,[l,c]),o.push(t)}else a!==c.TRACK_ID.substring(0,s)?(console.log("found next release:",c.TRACK_ID),l=c,s=0,t=null):(console.log("push track:",c.TRACK_ID,"prefixLength:",u),t.tracks.push(c))}}),console.log("all releases:",o),o},Me={class:"lm-release-list"},Ae={props:["lmclass"],setup(e){const o=e,l=S(M),s=b({lmclass:o.lmclass,releases:[]}),a=async t=>{const r=await l(K.key,t.all_tracks,De);s.releases=r,console.log("allTracksResult",r)};return B(()=>o.lmclass,async()=>{await a(o.lmclass)}),F(async()=>{console.log("mounted:",o.lmclass),o.lmclass&&await a(o.lmclass)}),(t,r)=>(i(!0),d(m,null,C(I(s).releases,c=>(i(),d("div",Me,[h(Se,{release:c},null,8,["release"])]))),256))}};const ke=w({props:["classId"],setup(e){const o=S(M),s=S(x)(v.key)||[],a=H();let t=null;s.length>0&&route.params&&(t=s.find(_=>_.id==classId));const r=b({loading:!0,currentClass:t});function c(_){if(_.length>0&&!t)return t=_[0],a.push({name:"LM Class Releases",params:{classId:t.id}}),null}async function u(_){this.state.loading=!0;const $=await o(v.key,v.path);this.state.currentClass=$.find(N=>N.id==_),O(()=>{this.state.loading=!1})}return c(s),{lmclasses:s,state:r,updateStore:o,fetchClasses:u,checkClassRoute:c}},watch:{classId:function(e){e&&this.fetchClasses(e)}},async mounted(){console.log("LMClassView mounted",this.classId),this.fetchClasses(this.classId)},async updated(){console.log("LMClassView updated",this.classId),this.checkClassRoute(this.lmclasses)},components:{LMClassReleaseList:Ae}}),we={class:"main-view"},xe={class:"lm-class-navigation"},Ke={key:0,class:"album-container album-container-loading"},Ne={key:1,class:"album-container"};function Pe(e,o,l,s,a,t){var u;const r=f("router-link"),c=f("LMClassReleaseList");return i(),d(m,null,[n("h1",null,p(((u=e.state.currentClass)==null?void 0:u.name)||"Les Mills"),1),n("div",we,[n("ul",xe,[(i(!0),d(m,null,C(e.lmclasses,_=>(i(),d("li",null,[h(r,{to:{name:"LM Class Releases",params:{classId:_.id}}},{default:R(()=>[g(p(_.name),1)]),_:2},1032,["to"])]))),256))]),e.state.loading?(i(),d("div",Ke,"Loading...")):(i(),d("div",Ne,[h(c,{lmclass:e.state.currentClass},null,8,["lmclass"])]))])],64)}var Ve=y(ke,[["render",Pe],["__scopeId","data-v-55dfe54d"]]);const je=w({setup(e){const o=E(),l=b(o.params);return{LMClassStore:ye,params:l}},watch:{$route:function(e){console.log("route changed!",e.params),this.params.classId=e.params.classId}},components:{DataProvider:ge,LMClassView:Ve}}),Be={class:"lesmills-home"};function Fe(e,o,l,s,a,t){const r=f("LMClassView"),c=f("DataProvider");return i(),d("div",Be,[h(c,{defaultStore:e.LMClassStore},{default:R(()=>[h(r,{classId:e.params.classId},null,8,["classId"])]),_:1},8,["defaultStore"])])}var A=y(je,[["render",Fe]]);const He=[{path:"/",name:"Home",component:he},{path:"/class",name:"LM Classes",component:A},{path:"/class/:classId/releases/",name:"LM Class Releases",component:A}],Oe=G({history:q(),routes:He}),Ee=U(pe);Ee.use(Oe).mount("#app");
