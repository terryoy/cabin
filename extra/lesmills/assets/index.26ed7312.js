import{o as d,c as _,a as o,t as p,F as m,r as y,p as L,b as I,d as g,e as V,f,g as T,h,w as $,i as S,j as H,k as O,l as k,u as b,m as B,n as M,q as E,s as F,v as w,x as j,y as G,z as q,A as U,B as z,C as Q}from"./vendor.da55cf35.js";const W=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const t of l)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(l){const t={};return l.integrity&&(t.integrity=l.integrity),l.referrerpolicy&&(t.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?t.credentials="include":l.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(l){if(l.ep)return;l.ep=!0;const t=r(l);fetch(l.href,t)}};W();var C=(e,n)=>{const r=e.__vccOpts||e;for(const[s,l]of n)r[s]=l;return r};const J=e=>(L("data-v-1a5c728e"),e=e(),I(),e),X={class:"album-release"},Y=J(()=>o("thead",null,[o("tr",null,[o("th",null,"Track"),o("th",null,"Song"),o("th",null,"Artists")])],-1)),Z=["track"],ee=g(),se=g(),te={props:{release:{title:String}},setup(e){return(n,r)=>(d(),_("section",X,[o("h3",null,p(e.release.title),1),o("table",null,[Y,o("tbody",null,[(d(!0),_(m,null,y(e.release.tracks,s=>(d(),_("tr",{track:s},[o("td",null,p(s.trackNo),1),ee,o("td",null,p(s.song),1),se,o("td",null,p(s.singer),1)],8,Z))),256))])])]))}};var ae=C(te,[["__scopeId","data-v-1a5c728e"]]);const x=(e,...n)=>{const r=location.origin+location.pathname+e;return console.debug("request api:",r),V.get(r).then(s=>(console.log(s),s.data)).catch(s=>{console.error(s)})};const oe={components:{Release:ae},props:{src:String},data(){return{albums:[]}},mounted(){x(this.src).then(e=>this.albums=e.reverse())}},le=e=>(L("data-v-d939aaac"),e=e(),I(),e),ne=le(()=>o("h1",{id:"page-title"},"Les Mills - Body Combat - All Albums",-1)),re={class:"album-container"};function ce(e,n,r,s,l,t){const i=f("Release");return d(),_(m,null,[ne,o("div",re,[(d(!0),_(m,null,y(l.albums,a=>(d(),T(i,{release:a},null,8,["release"]))),256))])],64)}var ie=C(oe,[["render",ce],["__scopeId","data-v-d939aaac"]]);const ue={id:"app"},de={id:"nav"},_e=g("Home"),pe=g(" | "),he=g("LM Classes"),me={setup(e){const n=window.location.hash;return console.log("current path:",n),(r,s)=>{const l=f("router-link"),t=f("router-view");return d(),_("div",ue,[o("div",de,[h(l,{to:{name:"Home"}},{default:$(()=>[_e]),_:1}),pe,h(l,{to:{name:"LM Classes"}},{default:$(()=>[he]),_:1})]),h(t)])}}},fe={setup(e){return(n,r)=>(d(),T(ie,{src:"/data/bc_list.json"}))}},ge=Symbol("Global Data Store"),A=Symbol("Global Data Store Update"),K=Symbol("Global Data Store Get"),Ce=e=>e;var ve={props:["defaultStore"],setup(e){const n=S(e.defaultStore||{}),r=H(O(n)),s=(t,i,a=Ce)=>x(i).then(c=>(n[t]=a(c),console.debug(`state[${t}] fetchData:`,n[t]),n[t])),l=t=>r[t];k(ge,r),k(A,s),k(K,l)},render(){return this.$slots.default()}};const R={path:"/data/class.json",key:"LMClass"},ye={key:"LMReleaseData"},N={key:"LMAllTracks"},Re={[R.key]:[],[ye.key]:{},[N.key]:[]};const $e=e=>(L("data-v-6ac17298"),e=e(),I(),e),be={class:"lm-album-release"},Le={class:"lm-release-title"},Ie=$e(()=>o("thead",null,[o("tr",null,[o("th",null,"Track No."),o("th",null,"Song"),o("th",null,"Artists"),o("th",null,"Duration"),o("th",null,"Exercise")])],-1)),Se=["track"],ke={props:["release"],setup(e){const r=e.release,s=t=>t.replaceAll(/[\(\'\)\â€™]/ig," "),l=async function(){console.log("copy release tracks:",r.tracks);const t=r.tracks.map(i=>`${s(i.ARTIST)} \u300A${s(i.TRACK)}\u300B`).join(`
`);await B(t),window.alert("Release tracks copied!")};return(t,i)=>(d(),_("section",be,[o("h3",Le,[g(p(b(r).title)+" ",1),o("button",{onClick:l},"Copy Tracks")]),o("table",null,[Ie,o("tbody",null,[(d(!0),_(m,null,y(b(r).tracks,a=>(d(),_("tr",{track:a},[o("td",null,p(a.TRACK_ID),1),o("td",null,p(a.TRACK),1),o("td",null,p(a.ARTIST),1),o("td",null,p(a.DURATION),1),o("td",null,p(a.TRACKNAME),1)],8,Se))),256))])])]))}};var Me=C(ke,[["__scopeId","data-v-6ac17298"]]);const Te=(e,n,r=!1)=>{let s=0;for(;s<e.length&&s<n.length;s++)if(e[s]!==n[s])return s;return s},Ae=e=>{const n=[];let r=null,s=0,l=null,t=null;const i=(a,c="",u=[])=>({title:a,prefix:c,tracks:u});return e.forEach(a=>{if(console.log("track:",a.TRACK_ID),!r)console.log("is first track",a.TRACK_ID),r=a,s=0;else{const c=Te(r.TRACK_ID,a.TRACK_ID);if(s==0){console.log("check prefix length:",c,r.TRACK_ID.substring(0,c));const u=Number.isInteger(+r.TRACK_ID[c]),v=c+1===a.TRACK_ID.length;s=c-2,u&&(console.log("isLastCharNumber",v),s=c-1),l=r.TRACK_ID.substring(0,s),console.log("prefix match:",l,s),t=i(l,l,[r,a]),n.push(t)}else l!==a.TRACK_ID.substring(0,s)?(console.log("found next release:",a.TRACK_ID),r=a,s=0,t=null):(console.log("push track:",a.TRACK_ID,"prefixLength:",c),t.tracks.push(a))}}),console.log("all releases:",n),n};const De=e=>(L("data-v-225e1ad2"),e=e(),I(),e),we={class:"lm-release-search"},xe=De(()=>o("label",null,"Search:",-1)),Ke=["value"],Ne={class:"lm-release-list-shortcut"},Pe={ref:"listContainer",class:"lm-release-list"},Ve={props:["lmclass"],setup(e){const n=e,r=M(A),s=S({lmclass:n.lmclass,keyword:"",releases:[],filterReleases:[]}),l=(a,c)=>{const u=(c||"").trim().toLowerCase();return u?a.filter(v=>(v.title||"").toLowerCase().indexOf(u)>-1):a},t=async a=>{const c=await r(N.key,a.all_tracks,Ae);s.releases=c,s.filterReleases=l(c,s.keyword)};E(()=>n.lmclass,async()=>{await t(n.lmclass)}),F(async()=>{n.lmclass&&await t(n.lmclass)});const i=a=>{s.keyword=a,s.filterReleases=l(s.releases,a),console.log("search:",a,s.filterReleases)};return(a,c)=>(d(),_(m,null,[o("div",we,[xe,o("input",{value:b(s).keyword,onInput:c[0]||(c[0]=u=>i(u.target.value))},null,40,Ke),o("button",{onClick:c[1]||(c[1]=()=>i(""))},"Clear"),o("span",Ne,[o("button",{onClick:c[2]||(c[2]=()=>this.$refs.listContainer.scrollTop=0)},"\u2B06"),o("button",{onClick:c[3]||(c[3]=()=>this.$refs.listContainer.scrollTop=this.$refs.listContainer.scrollHeight)},"\u2B07")])]),o("div",Pe,[(d(!0),_(m,null,y(b(s).filterReleases,u=>(d(),T(Me,{key:u.title,release:u},null,8,["release"]))),128))],512)],64))}};var He=C(Ve,[["__scopeId","data-v-225e1ad2"]]);const Oe=w({props:["classId"],setup(e){const n=M(A),s=M(K)(R.key)||[],l=j();let t=null;s.length>0&&route.params&&(t=s.find(u=>u.id==classId));const i=S({loading:!0,currentClass:t});function a(u){if(u.length>0&&!t)return t=u[0],l.push({name:"LM Class Releases",params:{classId:t.id}}),null}async function c(u){this.state.loading=!0;const v=await n(R.key,R.path);this.state.currentClass=v.find(P=>P.id==u),G(()=>{this.state.loading=!1})}return a(s),{lmclasses:s,state:i,updateStore:n,fetchClasses:c,checkClassRoute:a}},watch:{classId:function(e){e&&this.fetchClasses(e)}},async mounted(){console.log("LMClassView mounted",this.classId),this.fetchClasses(this.classId)},async updated(){console.log("LMClassView updated",this.classId),this.checkClassRoute(this.lmclasses)},components:{LMClassReleaseList:He}}),Be={class:"main-view"},Ee={class:"lm-class-navigation"},Fe={class:"lm-class-title"},je={key:0,class:"album-container album-container-loading"},Ge={key:1,class:"album-container"};function qe(e,n,r,s,l,t){var c;const i=f("router-link"),a=f("LMClassReleaseList");return d(),_("div",Be,[o("ul",Ee,[(d(!0),_(m,null,y(e.lmclasses,u=>(d(),_("li",null,[h(i,{to:{name:"LM Class Releases",params:{classId:u.id}}},{default:$(()=>[g(p(u.short),1)]),_:2},1032,["to"])]))),256))]),o("h1",Fe,p(((c=e.state.currentClass)==null?void 0:c.name)||"Les Mills"),1),e.state.loading?(d(),_("div",je,"Loading...")):(d(),_("div",Ge,[h(a,{lmclass:e.state.currentClass},null,8,["lmclass"])]))])}var Ue=C(Oe,[["render",qe],["__scopeId","data-v-367d9a72"]]);const ze=w({setup(e){const n=q(),r=S(n.params);return{LMClassStore:Re,params:r}},watch:{$route:function(e){console.log("route changed!",e.params),this.params.classId=e.params.classId}},components:{DataProvider:ve,LMClassView:Ue}}),Qe={class:"lesmills-home"};function We(e,n,r,s,l,t){const i=f("LMClassView"),a=f("DataProvider");return d(),_("div",Qe,[h(a,{defaultStore:e.LMClassStore},{default:$(()=>[h(i,{classId:e.params.classId},null,8,["classId"])]),_:1},8,["defaultStore"])])}var D=C(ze,[["render",We],["__scopeId","data-v-2cdb59f2"]]);const Je=[{path:"/",name:"Home",component:fe},{path:"/class",name:"LM Classes",component:D},{path:"/class/:classId/releases/",name:"LM Class Releases",component:D}],Xe=U({history:z(),routes:Je}),Ye=Q(me);Ye.use(Xe).mount("#app");
